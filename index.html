
<!DOCTYPE html>
<html>
<head>
  <title>SlideBoard for Teachers</title>
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/libs/pptxgen.bundle.js"></script>
  <style>
    .slide-preview {
      border: 1px solid #ccc;
      padding: 1rem;
      margin-top: 1rem;
      border-radius: 0.5rem;
      color: #333;
      cursor: move;
    }
    .slide-preview h3 { margin-top: 0; }
  </style>
</head>
<body>
  <h1>SlideBoard for Teachers</h1>
  <textarea id="lessonInput" rows="10" style="width:100%;" placeholder="Paste lesson notes..."></textarea>
  <button onclick="generateSlides()">Generate Slides</button>
  <button onclick="exportToPowerPoint()">ðŸ“¤ Export to PPTX</button>
  <div id="sampleSlides"></div>

  <script>
    let reorderedSlides = [];
    let draggedIdx = null;

    function generateSlides() {
      const text = document.getElementById('lessonInput').value;
      const lines = text.split('\n').map(l => l.trim()).filter(Boolean);
      let slides = [], currentSlide = '', title = '';
      lines.forEach(line => {
        if (/^(Grade Level|Subject|Topic|Duration|Lesson Objectives|Prior Knowledge|Introduction|Body of the Lesson|Key Concept|Body|Concept 1|Concept 2|Concept 3|Conclusion|Activity|Assessment|Extension)/i.test(line)) {
          if (currentSlide) {
            slides.push({ title, content: currentSlide });
            currentSlide = '';
          }
          title = line;
        } else {
          currentSlide += `<p>${line}</p>`;
        }
      });
      if (currentSlide) slides.push({ title, content: currentSlide });
      reorderedSlides = slides;
      renderSlides();
    }

    function renderSlides() {
      const container = document.getElementById('sampleSlides');
      container.innerHTML = '';
      reorderedSlides.forEach((slide, idx) => {
        const div = document.createElement('div');
        div.className = 'slide-preview';
        div.setAttribute('draggable', 'true');
        div.setAttribute('data-index', idx);
        div.innerHTML = `<h3>Slide ${idx + 1}: ${slide.title}</h3>${slide.content}`;
        div.addEventListener('dragstart', dragStart);
        div.addEventListener('dragover', dragOver);
        div.addEventListener('drop', drop);
        container.appendChild(div);
      });
    }

    function dragStart(e) {
      draggedIdx = +e.target.getAttribute('data-index');
    }

    function dragOver(e) {
      e.preventDefault();
    }

    function drop(e) {
      e.preventDefault();
      const dropIdx = +e.target.closest('.slide-preview').getAttribute('data-index');
      const moved = reorderedSlides.splice(draggedIdx, 1)[0];
      reorderedSlides.splice(dropIdx, 0, moved);
      renderSlides();
    }

    async function exportToPowerPoint() {
      const pptx = new PptxGenJS();
      pptx.defineLayout({ name: 'A4', width: 10, height: 5.625 });
      pptx.layout = 'A4';

      for (const slide of reorderedSlides) {
        const sld = pptx.addSlide();
        sld.background = { fill: "F0F4F8" };
        sld.addText(slide.title, { x: 0.5, y: 0.3, fontSize: 22, bold: true, color: "003366" });
        const content = slide.content.replace(/<[^>]+>/g, '');
        sld.addText(content, { x: 0.5, y: 1, w: 9, h: 4, fontSize: 14, color: "222222" });
      }

      await pptx.writeFile("SlideBoard_Presentation.pptx");
    }
  </script>
</body>
</html>
