
<!DOCTYPE html>
<html>
<head>
  <title>SlideBoard for Teachers</title>
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/libs/pptxgen.bundle.js"></script>
  <style>
    .slide-preview {
      border: 1px solid #ccc;
      padding: 1rem;
      margin-top: 1rem;
      border-radius: 0.5rem;
      color: #333;
      cursor: move;
    }
    .clickable-list button {
      display: block;
      width: 100%;
      text-align: left;
      background: #f1f1f1;
      margin-bottom: 4px;
      padding: 8px;
      border: none;
      border-radius: 0.25rem;
      cursor: pointer;
    }
    .clickable-list button:hover {
      background: #e0e0e0;
    }
  </style>
</head>
<body class="p-4 grid gap-6">
  <div class="text-2xl font-bold">SlideBoard for Teachers</div>
  <div class="flex gap-4">
    <button class="rounded-2xl shadow px-4 py-2" onclick="navigate('lessonSlides')">Lesson to Slides</button>
  </div>
  <div class="grid grid-cols-1 gap-6">
    <div id="lessonSlides" class="feature-section rounded-2xl shadow p-4">
      <div class="font-semibold text-lg mb-2">ðŸ“„ Lesson Plan to Slides</div>
      <textarea id="lessonInput" class="w-full h-40 p-2 rounded border" placeholder="Paste your structured lesson note here..."></textarea>
      <button class="mt-2 px-4 py-2 rounded bg-blue-500 text-white" onclick="generateSlides()">Generate Slides</button>
      <div id="sampleSlides"></div>
      <div class="flex gap-2 mt-4">
        <button class="px-4 py-2 rounded bg-purple-600 text-white" onclick="exportToPowerPoint()">ðŸ“¤ Export to PPTX</button>
      </div>
    </div>
  </div>
  <script>
    let reorderedSlides = [];
    function navigate(section) {
      document.querySelectorAll('.feature-section').forEach(div => div.style.display = 'none');
      document.getElementById(section).style.display = 'block';
    }
    function generateSlides() {
      const text = document.getElementById('lessonInput').value;
      const lines = text.split('\n').map(l => l.trim()).filter(Boolean);
      let slides = [], currentSlide = '', title = '';
      lines.forEach(line => {
        if (line.match(/^\s*(Grade Level|Subject|Topic|Duration|Lesson Objectives|Prior Knowledge|Introduction|Body of the Lesson|Key Concept|Body|Concept 1|Concept 2|Concept 3|Conclusion|Activity|Assessment|Extension)/i)) {
          if (currentSlide) {
            slides.push({ title, content: currentSlide });
            currentSlide = '';
          }
          title = line;
        } else {
          currentSlide += `<p>${line}</p>`;
        }
      });
      if (currentSlide) slides.push({ title, content: currentSlide });
      reorderedSlides = [...slides];
      renderSlides();
    }
    function renderSlides() {
      const output = document.getElementById('sampleSlides');
      output.innerHTML = '';
      reorderedSlides.forEach((slide, idx) => {
        const slideDiv = document.createElement('div');
        slideDiv.className = `slide-preview`;
        slideDiv.innerHTML = `<h3>Slide ${idx + 1}: ${slide.title}</h3>${slide.content}`;
        output.appendChild(slideDiv);
      });
    }
    async function getDalleImage(prompt) {
      const mockImages = {
        introduction: "https://via.placeholder.com/300x200.png?text=Introduction+Image",
        conclusion: "https://via.placeholder.com/300x200.png?text=Conclusion+Image",
        assessment: "https://via.placeholder.com/300x200.png?text=Assessment+Image",
        quiz: "https://via.placeholder.com/300x200.png?text=Quiz+Image",
        activity: "https://via.placeholder.com/300x200.png?text=Activity+Image"
      };
      const lowerPrompt = prompt.toLowerCase();
      for (const keyword in mockImages) {
        if (lowerPrompt.includes(keyword)) {
          return mockImages[keyword];
        }
      }
      return "https://via.placeholder.com/300x200.png?text=Slide+Image";
    }
    function getSubjectVisual(subject) {
      const subjectMap = {
        science: "https://cdn-icons-png.flaticon.com/512/4149/4149650.png",
        math: "https://cdn-icons-png.flaticon.com/512/716/716370.png",
        english: "https://cdn-icons-png.flaticon.com/512/3135/3135715.png",
        geography: "https://cdn-icons-png.flaticon.com/512/854/854878.png",
        chemistry: "https://cdn-icons-png.flaticon.com/512/2907/2907973.png",
        physics: "https://cdn-icons-png.flaticon.com/512/3176/3176297.png",
        biology: "https://cdn-icons-png.flaticon.com/512/2165/2165959.png",
        history: "https://cdn-icons-png.flaticon.com/512/4129/4129528.png",
        government: "https://cdn-icons-png.flaticon.com/512/1940/1940631.png",
        economics: "https://cdn-icons-png.flaticon.com/512/2830/2830305.png",
        commerce: "https://cdn-icons-png.flaticon.com/512/3449/3449365.png",
        literature: "https://cdn-icons-png.flaticon.com/512/3004/3004321.png"
      };
      const key = subject.toLowerCase().trim();
      return subjectMap[key] || null;
    }
    async function exportToPowerPoint() {
      const pptx = new PptxGenJS();
      pptx.defineLayout({ name: "Custom", width: 10, height: 5.625 });
      pptx.layout = "Custom";
      let subject = "general";
      for (const s of reorderedSlides) {
        if (s.title.toLowerCase().includes("subject")) {
          subject = s.content.replace(/<[^>]+>/g, '').split(":").pop().trim();
          break;
        }
      }
      const subjectImage = getSubjectVisual(subject);
      for (const slide of reorderedSlides) {
        const sld = pptx.addSlide();
        sld.background = { fill: "F0F4F8" };
        sld.addText(slide.title, { x: 0.5, y: 0.3, fontSize: 22, bold: true, fontFace: "Arial", color: "003366" });
        const contentText = slide.content.replace(/<[^>]+>/g, '');
        sld.addText(contentText, { x: 0.5, y: 1.0, w: 8, h: 3, fontSize: 14, color: "222222", fontFace: "Calibri Light", lineSpacingMultiple: 1.15 });
        if (subjectImage) {
          sld.addImage({ url: subjectImage, x: 0.3, y: 0.2, w: 0.8, h: 0.8 });
        }
        const prompt = `Illustrate this slide concept for teachers: ${slide.title} - ${contentText}`;
        const imgUrl = await getDalleImage(prompt);
        if (imgUrl) {
          sld.addImage({ url: imgUrl, x: 6.5, y: 0.5, w: 3, h: 2 });
        }
      }
      pptx.writeFile("SlideBoard_Presentation.pptx");
    }
    window.onload = () => navigate('lessonSlides');
  </script>
</body>
</html>
